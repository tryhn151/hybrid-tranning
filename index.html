<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B·∫£ng ƒêi·ªÅu Khi·ªÉn V·∫≠n ƒê·ªông Vi√™n Hybrid</title>
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#4A6C6F"/>
    <link rel="apple-touch-icon" href="icons/icon-192x192.png">
    <link rel="manifest" href="manifest.json">

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Chosen Palette: Calm Focus -->
    <!-- Application Structure Plan: A tabbed, dashboard-style Single Page Application. The structure is task-oriented (Dashboard, Schedule, Nutrition, Recovery) rather than following the linear report format. This provides immediate, actionable information ('What's today's plan?') on the dashboard and allows for deep-dives into specific areas via tabs. The core interaction is a week selector on the 'Training Schedule' tab that dynamically updates a 7-day grid, with clickable days revealing detailed workouts. This design prioritizes usability and quick access to relevant daily information. -->
    <!-- Visualization & Content Choices: 1. **Personal Metrics (Dashboard): Goal: Inform.** Method: Dynamic stats in cards (HTML/Tailwind). Justification: Quick, scannable overview of key numbers. 2. **Macro Split (Dashboard/Nutrition): Goal: Proportions.** Method: Donut Chart (Chart.js). Justification: Classic, instant visual for part-to-whole relationships. 3. **Long Run Progression (Training): Goal: Change over time.** Method: Line Chart (Chart.js). Justification: Clearly shows the progressive overload principle applied to the key marathon training run. 4. **Weekly Schedule (Training): Goal: Organize.** Method: Interactive 7-day grid (HTML/Tailwind + JS). Interaction: Week selector updates the grid; clicking a day shows details. Justification: Most intuitive way to view a weekly calendar. Hiding details until clicked prevents information overload. 5. **Exercise/Recovery Details: Goal: Instruct.** Method: Accordions/Modals (HTML + JS). Justification: Hides complex information until requested, keeping the UI clean. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->

    <style>
        body {
            font-family: 'Be Vietnam Pro', sans-serif;
            background-color: #F8F7F4;
            color: #3D3B3A;
        }
        .nav-item {
            cursor: pointer;
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            transition: all 0.3s ease;
            color: #78716C;
            font-weight: 500;
        }
        .nav-item.active, .nav-item:hover {
            background-color: #4A6C6F;
            color: #FFFFFF;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 450px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 300px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
                max-height: 350px;
            }
        }
        .card {
            background-color: #FFFFFF;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.05), 0 2px 4px -2px rgb(0 0 0 / 0.05);
            transition: all 0.3s ease;
        }
        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.07), 0 4px 6px -4px rgb(0 0 0 / 0.07);
        }
        .section-title {
            color: #4A6C6F;
            font-weight: 700;
            font-size: 1.875rem;
            line-height: 2.25rem;
            border-bottom: 3px solid #D1D5DB;
            padding-bottom: 0.5rem;
        }
        .week-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            background: #4A6C6F;
            cursor: pointer;
            border-radius: 50%;
        }
        .week-slider::-moz-range-thumb {
            width: 24px;
            height: 24px;
            background: #4A6C6F;
            cursor: pointer;
            border-radius: 50%;
        }
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-out;
        }
    </style>
</head>
<body class="antialiased">

    <div class="container mx-auto p-4 md:p-8 max-w-7xl">
        <!-- HEADER -->
        <header class="text-center mb-8">
            <h1 class="text-3xl md:text-5xl font-bold text-[#3B5A5C]">L·ªô Tr√¨nh V·∫≠n ƒê·ªông Vi√™n Hybrid</h1>
            <p class="text-lg text-gray-600 mt-2">16 Tu·∫ßn Chinh Ph·ª•c S·ª©c M·∫°nh & Marathon Sub 4:30</p>
        </header>

        <!-- NAVIGATION -->
        <nav class="flex flex-wrap justify-center items-center mb-8 bg-white/70 backdrop-blur-sm p-2 rounded-xl shadow-sm sticky top-4 z-50">
            <a id="nav-dashboard" class="nav-item active">üìä B·∫£ng ƒêi·ªÅu Khi·ªÉn</a>
            <a id="nav-schedule" class="nav-item">üóìÔ∏è L·ªãch T·∫≠p</a>
            <a id="nav-nutrition" class="nav-item">ü•ó Dinh D∆∞·ª°ng</a>
            <a id="nav-recovery" class="nav-item">üßò Ph·ª•c H·ªìi & T∆∞ Th·∫ø</a>
        </nav>

        <!-- MAIN CONTENT -->
        <main>
            <!-- DASHBOARD VIEW -->
            <section id="view-dashboard">
                <h2 class="section-title mb-6">B·∫£ng ƒêi·ªÅu Khi·ªÉn</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Today's Plan -->
                    <div class="md:col-span-2 lg:col-span-3 p-6 card bg-gradient-to-br from-teal-50 to-[#E0E7E9]">
                        <h3 class="text-2xl font-bold text-gray-800 mb-4">K·∫ø Ho·∫°ch H√¥m Nay (<span id="today-date"></span>)</h3>
                        <div id="today-plan-container" class="space-y-4">
                            <!-- JS will populate this -->
                        </div>
                    </div>
                    
                    <!-- Personal Metrics -->
                    <div class="p-6 card">
                        <h3 class="text-xl font-bold mb-3 text-gray-800">Ch·ªâ S·ªë C√° Nh√¢n</h3>
                        <ul class="space-y-2 text-gray-700">
                            <li><strong>Tu·ªïi:</strong> 24</li>
                            <li><strong>Chi·ªÅu cao:</strong> 167 cm</li>
                            <li><strong>C√¢n n·∫∑ng:</strong> 58 kg</li>
                            <li><strong>M·ª•c ti√™u Marathon:</strong> < 4h30</li>
                        </ul>
                    </div>
                    
                    <!-- Calorie Goals -->
                    <div class="p-6 card text-center flex flex-col justify-center items-center">
                        <h3 class="text-xl font-bold mb-2 text-gray-800">M·ª•c Ti√™u NƒÉng L∆∞·ª£ng</h3>
                        <p class="text-4xl font-bold text-[#4A6C6F]">~3000</p>
                        <p class="text-gray-600">kcal/ng√†y</p>
                        <p class="text-sm mt-2 text-gray-500">(BMR: ~1509 | TDEE: ~2603)</p>
                    </div>

                    <!-- Macro Split -->
                    <div class="p-6 card">
                        <h3 class="text-xl font-bold mb-3 text-center text-gray-800">Dinh D∆∞·ª°ng ƒêa L∆∞·ª£ng</h3>
                        <div class="chart-container">
                            <canvas id="macroChart"></canvas>
                        </div>
                         <div class="flex justify-around mt-4 text-xs md:text-sm text-center">
                            <div><span class="font-bold block text-blue-600">Carb</span>375g</div>
                            <div><span class="font-bold block text-green-600">Protein</span>225g</div>
                            <div><span class="font-bold block text-red-600">Fat</span>67g</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- SCHEDULE VIEW -->
            <section id="view-schedule" class="hidden">
                <h2 class="section-title mb-6">L·ªãch T·∫≠p Chi Ti·∫øt 16 Tu·∫ßn</h2>
                
                <!-- Week Selector -->
                <div class="mb-8 p-4 card">
                    <label for="week-selector" class="block text-xl font-bold text-gray-800 mb-2">Ch·ªçn Tu·∫ßn: <span id="week-label" class="text-[#4A6C6F]">1</span></label>
                    <input type="range" id="week-selector" min="1" max="16" value="1" class="w-full h-3 bg-gray-200 rounded-lg appearance-none cursor-pointer week-slider">
                    <div id="phase-info" class="text-center font-semibold mt-2 text-gray-600"></div>
                </div>

                <!-- Weekly Schedule Grid -->
                <div id="schedule-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-7 gap-4">
                    <!-- JS will populate this -->
                </div>

                 <!-- Long Run Progression Chart -->
                <div class="mt-12 p-6 card">
                    <h3 class="text-2xl font-bold mb-4 text-center text-gray-800">Ti·∫øn ƒê·ªô Ch·∫°y D√†i (Long Run)</h3>
                    <div class="chart-container h-64 md:h-80 max-w-4xl">
                        <canvas id="longRunChart"></canvas>
                    </div>
                </div>
            </section>

            <!-- NUTRITION VIEW -->
            <section id="view-nutrition" class="hidden">
                <h2 class="section-title mb-6">K·∫ø Ho·∫°ch Dinh D∆∞·ª°ng</h2>
                 <p class="mb-8 text-gray-700 max-w-4xl">Dinh d∆∞·ª°ng l√† n·ªÅn t·∫£ng cho s·ª± ph·ª•c h·ªìi v√† ph√°t tri·ªÉn. K·∫ø ho·∫°ch n√†y t·∫≠p trung v√†o vi·ªác n·∫°p ƒë·ªß nƒÉng l∆∞·ª£ng (~3000 kcal) v·ªõi t·ª∑ l·ªá dinh d∆∞·ª°ng ƒëa l∆∞·ª£ng t·ªëi ∆∞u (50% Carb, 30% Protein, 20% Fat) th√¥ng qua c√°c b·ªØa ƒÉn quen thu·ªôc c·ªßa ng∆∞·ªùi Vi·ªát. Ch√∫ tr·ªçng th·ªùi ƒëi·ªÉm n·∫°p nƒÉng l∆∞·ª£ng quanh c√°c bu·ªïi t·∫≠p l√† ch√¨a kh√≥a th√†nh c√¥ng.</p>
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <div class="lg:col-span-2">
                        <h3 class="text-2xl font-bold mb-4 text-gray-800">Th·ª±c ƒê∆°n M·∫´u (~3000 kcal)</h3>
                        <div class="space-y-4">
                            <div class="card p-4"><strong>B·ªØa 1 (6:30, Tr∆∞·ªõc ch·∫°y):</strong> 1 qu·∫£ chu·ªëi, c√† ph√™ ƒëen. (~120 kcal)</div>
                            <div class="card p-4"><strong>B·ªØa 2 (9:00, Sau ch·∫°y):</strong> 1 mu·ªóng whey protein + 250ml s·ªØa t∆∞∆°i + 1 qu·∫£ chu·ªëi. (~350 kcal)</div>
                            <div class="card p-4"><strong>B·ªØa 3 (12:00, Tr∆∞a):</strong> 1 t√¥ Ph·ªü b√≤ t√°i l·ªõn (th√™m th·ªãt). (~550 kcal)</div>
                            <div class="card p-4"><strong>B·ªØa 4 (15:30, Ph·ª•):</strong> 1 h·ªôp s·ªØa chua Hy L·∫°p + 30g h·∫°nh nh√¢n. (~350 kcal)</div>
                            <div class="card p-4"><strong>B·ªØa 5 (18:00, Tr∆∞·ªõc gym):</strong> 2 tr·ª©ng lu·ªôc + 1 khoai lang v·ª´a. (~320 kcal)</div>
                            <div class="card p-4"><strong>B·ªØa 6 (20:30, T·ªëi):</strong> 250g ·ª©c g√† n∆∞·ªõng + 2 b√°t c∆°m g·∫°o l·ª©t + rau lu·ªôc. (~900 kcal)</div>
                             <div class="card p-4"><strong>B·ªØa 7 (22:00, Ph·ª• t·ªëi):</strong> 1 ly s·ªØa h·∫°t ho·∫∑c ph√¥ mai Cottage. (~200 kcal)</div>
                        </div>
                    </div>
                    <div>
                        <h3 class="text-2xl font-bold mb-4 text-gray-800">Th∆∞ Vi·ªán Th·ª±c Ph·∫©m</h3>
                        <p class="mb-4 text-gray-600">Linh ho·∫°t l·ª±a ch·ªçn c√°c th·ª±c ph·∫©m sau ƒë·ªÉ x√¢y d·ª±ng b·ªØa ƒÉn c·ªßa b·∫°n.</p>
                        <div class="space-y-4">
                            <div>
                                <h4 class="font-bold text-lg text-green-700">Ngu·ªìn Protein Ch·∫•t L∆∞·ª£ng</h4>
                                <p class="text-gray-700">·ª®c g√†, b√≤ thƒÉn, c√° h·ªìi, c√° di√™u h·ªìng, t√¥m, tr·ª©ng, ƒë·∫≠u h≈©, s·ªØa chua Hy L·∫°p, whey.</p>
                            </div>
                            <div>
                                <h4 class="font-bold text-lg text-blue-700">Ngu·ªìn Carb Ph·ª©c H·ª£p</h4>
                                <p class="text-gray-700">C∆°m (g·∫°o l·ª©t, tr·∫Øng), b√∫n, ph·ªü, khoai lang, y·∫øn m·∫°ch, b√°nh m√¨ nguy√™n c√°m, chu·ªëi, xo√†i.</p>
                            </div>
                            <div>
                                <h4 class="font-bold text-lg text-red-700">Ngu·ªìn Ch·∫•t B√©o T·ªët</h4>
                                <p class="text-gray-700">D·∫ßu √¥ liu, qu·∫£ b∆°, h·∫°nh nh√¢n, √≥c ch√≥, b∆° ƒë·∫≠u ph·ªông, l√≤ng ƒë·ªè tr·ª©ng.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- RECOVERY VIEW -->
            <section id="view-recovery" class="hidden">
                 <h2 class="section-title mb-6">Ph·ª•c H·ªìi & C·∫£i Thi·ªán T∆∞ Th·∫ø</h2>
                 <p class="mb-8 text-gray-700 max-w-4xl">S·ª± ti·∫øn b·ªô kh√¥ng x·∫£y ra trong l√∫c t·∫≠p m√† l√† trong l√∫c ngh·ªâ ng∆°i. ∆Øu ti√™n ph·ª•c h·ªìi th√¥ng qua gi·∫•c ng·ªß, gi√£n c∆° v√† c√°c b√†i t·∫≠p b·ªï tr·ª£ l√† y·∫øu t·ªë quy·∫øt ƒë·ªãnh ƒë·ªÉ b·∫°n m·∫°nh h∆°n, nhanh h∆°n v√† tr√°nh xa ch·∫•n th∆∞∆°ng. Ph·∫ßn n√†y ƒë·∫∑c bi·ªát t·∫≠p trung v√†o c√°c b√†i t·∫≠p kh·∫Øc ph·ª•c ch·ª©ng g√π l∆∞ng.</p>
                <div class="space-y-6">
                    <!-- Posture Correction -->
                    <div class="card p-6">
                        <h3 class="text-2xl font-bold mb-4 text-gray-800">K·∫ø Ho·∫°ch C·∫£i Thi·ªán T∆∞ Th·∫ø (Ch·ªëng G√π L∆∞ng)</h3>
                        <p class="mb-4 text-gray-600">T√≠ch h·ª£p c√°c b√†i t·∫≠p n√†y v√†o ng√†y t·∫≠p PULL v√† ph·∫ßn kh·ªüi ƒë·ªông ƒë·ªÉ tƒÉng c∆∞·ªùng s·ª©c m·∫°nh cho l∆∞ng tr√™n, k√©o vai v·ªÅ v·ªã tr√≠ t·ª± nhi√™n.</p>
                        <div class="space-y-2">
                             <div class="accordion-item border-b">
                                <button class="accordion-header w-full text-left py-3 font-semibold text-lg flex justify-between items-center">
                                    <span>Face Pulls (B√†i t·∫≠p Vua)</span><span>+</span>
                                </button>
                                <div class="accordion-content">
                                    <p class="p-4 text-gray-700 bg-gray-50 rounded"><strong>M·ª•c ti√™u:</strong> TƒÉng c∆∞·ªùng c∆° delta sau v√† c√°c c∆° xoay ngo√†i vai.<br><strong>Th·ª±c hi·ªán:</strong> 3 hi·ªáp x 15-20 l·∫ßn l·∫∑p v√†o cu·ªëi bu·ªïi t·∫≠p Pull. K√©o d√¢y c√°p v·ªÅ ph√≠a m·∫∑t, t·∫≠p trung √©p hai b·∫£ vai v√†o nhau.</p>
                                </div>
                            </div>
                             <div class="accordion-item border-b">
                                <button class="accordion-header w-full text-left py-3 font-semibold text-lg flex justify-between items-center">
                                    <span>Wall Angels</span><span>+</span>
                                </button>
                                <div class="accordion-content">
                                    <p class="p-4 text-gray-700 bg-gray-50 rounded"><strong>M·ª•c ti√™u:</strong> K√≠ch ho·∫°t c∆° thang gi·ªØa v√† d∆∞·ªõi.<br><strong>Th·ª±c hi·ªán:</strong> 2 hi·ªáp x 10-12 l·∫ßn l·∫∑p khi kh·ªüi ƒë·ªông. ƒê·ª©ng d·ª±a l∆∞ng v√†o t∆∞·ªùng, tr∆∞·ª£t tay l√™n xu·ªëng trong khi gi·ªØ khu·ª∑u tay v√† mu b√†n tay ch·∫°m t∆∞·ªùng.</p>
                                </div>
                            </div>
                              <div class="accordion-item border-b">
                                <button class="accordion-header w-full text-left py-3 font-semibold text-lg flex justify-between items-center">
                                    <span>Band Pull-Aparts</span><span>+</span>
                                </button>
                                <div class="accordion-content">
                                    <p class="p-4 text-gray-700 bg-gray-50 rounded"><strong>M·ª•c ti√™u:</strong> K√≠ch ho·∫°t l∆∞ng tr√™n.<br><strong>Th·ª±c hi·ªán:</strong> 3 hi·ªáp x 20 l·∫ßn l·∫∑p. D√πng d√¢y kh√°ng l·ª±c, k√©o hai tay sang ngang, gi·ªØ tay th·∫≥ng. C√≥ th·ªÉ t·∫≠p gi·ªØa c√°c hi·ªáp c·ªßa ng√†y PUSH.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Stretching & Mobility -->
                    <div class="card p-6">
                        <h3 class="text-2xl font-bold mb-4 text-gray-800">Gi√£n C∆° & LƒÉn B·ªçt (Foam Rolling)</h3>
                        <ul class="list-disc list-inside space-y-2 text-gray-700">
                           <li><strong>Kh·ªüi ƒë·ªông ƒë·ªông (5-10 ph√∫t):</strong> Lu√¥n th·ª±c hi·ªán tr∆∞·ªõc m·ªói bu·ªïi t·∫≠p. Bao g·ªìm n√¢ng cao g·ªëi, g√≥t ch·∫°m m√¥ng, ƒë√° lƒÉng ch√¢n.</li>
                           <li><strong>Gi√£n c∆° tƒ©nh (10-15 ph√∫t):</strong> Th·ª±c hi·ªán sau m·ªói bu·ªïi t·∫≠p khi c∆° c√≤n ·∫•m. Gi·ªØ m·ªói ƒë·ªông t√°c 30-60 gi√¢y. T·∫≠p trung v√†o ƒë√πi tr∆∞·ªõc, ƒë√πi sau, h√¥ng, m√¥ng, ng·ª±c v√† l∆∞ng.</li>
                           <li><strong>LƒÉn b·ªçt:</strong> 2-3 l·∫ßn/tu·∫ßn, t·∫≠p trung v√†o c√°c nh√≥m c∆° l·ªõn b·ªã ƒëau m·ªèi nh∆∞ ƒë√πi, b·∫Øp ch√¢n, v√† l∆∞ng tr√™n.</li>
                        </ul>
                    </div>
                    <!-- Sleep & Rest -->
                    <div class="card p-6">
                        <h3 class="text-2xl font-bold mb-4 text-gray-800">Gi·∫•c Ng·ªß & Ng√†y Ngh·ªâ</h3>
                        <ul class="list-disc list-inside space-y-2 text-gray-700">
                            <li><strong>Gi·∫•c ng·ªß:</strong> M·ª•c ti√™u 7-9 ti·∫øng/ƒë√™m. ƒê√¢y l√† th·ªùi gian quan tr·ªçng nh·∫•t ƒë·ªÉ c∆° th·ªÉ s·ª≠a ch·ªØa v√† ph√°t tri·ªÉn.</li>
                            <li><strong>Ph·ª•c h·ªìi ch·ªß ƒë·ªông (Th·ª© 4):</strong> ƒêi b·ªô nh·∫π, b∆°i l·ªôi ho·∫∑c yoga ƒë·ªÉ tƒÉng l∆∞u th√¥ng m√°u, ƒë·∫©y nhanh qu√° tr√¨nh ph·ª•c h·ªìi.</li>
                            <li><strong>Ngh·ªâ ho√†n to√†n (Th·ª© 7):</strong> Cho ph√©p c∆° th·ªÉ v√† h·ªá th·∫ßn kinh ƒë∆∞·ª£c ngh·ªâ ng∆°i tuy·ªát ƒë·ªëi.</li>
                        </ul>
                    </div>
                </div>
            </section>
        </main>
    </div>

<script>
    // PWA Service Worker Registration
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
            navigator.serviceWorker.register('/sw.js')
                .then(registration => {
                    console.log('Service Worker registered: ', registration);
                })
                .catch(registrationError => {
                    console.log('Service Worker registration failed: ', registrationError);
                });
        });
    }

    // Original App Logic
    document.addEventListener('DOMContentLoaded', function() {
        const views = {
            dashboard: document.getElementById('view-dashboard'),
            schedule: document.getElementById('view-schedule'),
            nutrition: document.getElementById('view-nutrition'),
            recovery: document.getElementById('view-recovery'),
        };

        const navItems = {
            dashboard: document.getElementById('nav-dashboard'),
            schedule: document.getElementById('nav-schedule'),
            nutrition: document.getElementById('nav-nutrition'),
            recovery: document.getElementById('nav-recovery'),
        };

        const trainingData = {
            push: { 
                phase1: [
                    "Barbell Bench Press: 4x8-10",
                    "Incline Dumbbell Press: 3x10-12",
                    "Overhead Press: 4x8-10",
                    "Dumbbell Lateral Raises: 3x12-15",
                    "Triceps Pushdowns: 3x12-15",
                    "Wall Angels (T∆∞ th·∫ø): 2x10-12",
                ],
                phase2: [
                    "Barbell Bench Press: 5x5-6",
                    "Overhead Press: 4x5-6",
                    "Incline Dumbbell Press: 3x8-10",
                    "Dumbbell Lateral Raises: 3x12-15",
                    "Triceps Pushdowns: 3x10-12",
                ]
            },
            pull: {
                phase1: [
                    "Deadlifts: 4x6-8",
                    "Pull-ups / Lat Pulldowns: 4x8-12",
                    "Bent-Over Barbell Rows: 3x8-10",
                    "Face Pulls (T∆∞ th·∫ø): 3x15-20",
                    "Barbell Curls: 3x10-12",
                ],
                phase2: [
                    "Deadlifts: 1x5 (N·∫∑ng) ho·∫∑c RDLs 4x8-10",
                    "Pull-ups / Lat Pulldowns: 4x6-8",
                    "Bent-Over Barbell Rows: 3x8-10",
                    "Face Pulls (T∆∞ th·∫ø): 3x15-20",
                    "Barbell Curls: 3x10-12",
                ]
            },
            legs: {
                phase1: [
                    "Barbell Back Squats: 4x8-10",
                    "Romanian Deadlifts (RDLs): 3x10-12",
                    "Dumbbell Lunges: 3x10-12/ch√¢n",
                    "Leg Press: 3x12-15",
                    "Standing Calf Raises: 4x15-20",
                ],
                 phase2: [
                    "Barbell Back Squats: 5x5-6",
                    "Romanian Deadlifts (RDLs): 3x8-10",
                    "Dumbbell Lunges: 3x10-12/ch√¢n",
                    "Leg Extensions: 3x12-15",
                    "Standing Calf Raises: 4x15-20",
                ]
            },
            running: {
                easy: { phase1: "5-8 km (Pace 7:25-7:55/km)", phase2: "6-10 km (Pace 7:25-7:55/km)" },
                quality: { 
                    phase1: "Intervals: 6x800m (Pace 5:20-5:35/km)", 
                    phase2: "Tempo Run: 6-8 km (Pace 6:15-6:25/km)" 
                },
                longRunKm: [12, 14, 16, 18, 16, 20, 22, 24, 26, 28, 30, 32, 28, 20, 12, 5],
                taper: {
                    week14: { easy: "5km", quality: "3km Tempo nh·∫π", long: "18-20km"},
                    week15: { easy: "4km", quality: "2km Tempo nh·∫π", long: "10-12km"},
                    week16: { easy: "3km", quality: "Ngh·ªâ", long: "RACE DAY!"},
                }
            },
        };

        function getWeekData(week) {
            let phase = week <= 8 ? 'phase1' : 'phase2';
            let gymSchedule = {
                push: trainingData.push[phase],
                pull: trainingData.pull[phase],
                legs: trainingData.legs[phase],
            };
            let runSchedule = {
                easy: trainingData.running.easy[phase],
                quality: trainingData.running.quality[phase],
                long: `${trainingData.running.longRunKm[week-1]} km (Pace 6:55-7:25/km)`,
            };

            if (week >= 14) { // Taper phase
                const taperWeek = trainingData.running.taper[`week${week}`];
                runSchedule.easy = taperWeek.easy;
                runSchedule.quality = taperWeek.quality;
                runSchedule.long = taperWeek.long;
                
                if (week == 14) gymSchedule = {push: ["To√†n th√¢n nh·∫π 50%"], pull: ["Ngh·ªâ"], legs: ["To√†n th√¢n nh·∫π 50%"] };
                else if (week == 15) gymSchedule = {push: ["Ngh·ªâ"], pull: ["To√†n th√¢n r·∫•t nh·∫π"], legs: ["Ngh·ªâ"] };
                else gymSchedule = {push: ["Ngh·ªâ"], pull: ["Ngh·ªâ"], legs: ["Ngh·ªâ"] };
            }

            return {
                Mon: { run: runSchedule.easy, gym: { type: 'PUSH', exercises: gymSchedule.push }},
                Tue: { run: runSchedule.quality, gym: { type: 'PULL', exercises: gymSchedule.pull }},
                Wed: { run: "Ph·ª•c h·ªìi ch·ªß ƒë·ªông (ƒëi b·ªô/yoga)", gym: null },
                Thu: { run: runSchedule.easy, gym: { type: 'LEGS', exercises: gymSchedule.legs }},
                Fri: { run: null, gym: { type: 'TH·ªÇ THAO', exercises: ["ƒê√° b√≥ng h√†ng tu·∫ßn"] }},
                Sat: { run: "NGH·ªà HO√ÄN TO√ÄN", gym: null },
                Sun: { run: runSchedule.long, gym: null }
            };
        }
        
        function navigateTo(viewId) {
            Object.values(views).forEach(v => v.classList.add('hidden'));
            views[viewId].classList.remove('hidden');

            Object.values(navItems).forEach(item => item.classList.remove('active'));
            navItems[viewId].classList.add('active');
        }

        Object.keys(navItems).forEach(key => {
            navItems[key].addEventListener('click', () => navigateTo(key));
        });

        const macroCtx = document.getElementById('macroChart').getContext('2d');
        new Chart(macroCtx, {
            type: 'doughnut',
            data: {
                labels: ['Carbohydrate (50%)', 'Protein (30%)', 'Ch·∫•t b√©o (20%)'],
                datasets: [{
                    data: [50, 30, 20],
                    backgroundColor: ['#3B82F6', '#10B981', '#EF4444'],
                    borderColor: '#F8F7F4',
                    borderWidth: 4,
                    hoverOffset: 8
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom',
                        labels: {
                            font: {
                                family: "'Be Vietnam Pro', sans-serif",
                                size: 12
                            },
                            boxWidth: 20,
                            padding: 20
                        }
                    }
                },
                cutout: '60%'
            }
        });

        const longRunCtx = document.getElementById('longRunChart').getContext('2d');
        new Chart(longRunCtx, {
            type: 'line',
            data: {
                labels: Array.from({length: 16}, (_, i) => `Tu·∫ßn ${i + 1}`),
                datasets: [{
                    label: 'Qu√£ng ƒë∆∞·ªùng Ch·∫°y D√†i (km)',
                    data: trainingData.running.longRunKm,
                    fill: true,
                    backgroundColor: 'rgba(74, 108, 111, 0.1)',
                    borderColor: '#4A6C6F',
                    tension: 0.3,
                    pointBackgroundColor: '#4A6C6F',
                    pointRadius: 4,
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        beginAtZero: true,
                        title: { display: true, text: 'Qu√£ng ƒë∆∞·ªùng (km)' }
                    },
                    x: {
                        title: { display: true, text: 'Tu·∫ßn Luy·ªán T·∫≠p' }
                    }
                },
                plugins: {
                    legend: { display: false }
                }
            }
        });

        const weekSelector = document.getElementById('week-selector');
        const weekLabel = document.getElementById('week-label');
        const scheduleGrid = document.getElementById('schedule-grid');
        const phaseInfo = document.getElementById('phase-info');

        function renderSchedule(week) {
            weekLabel.textContent = week;
            let phaseText = '';
            if (week <= 8) phaseText = 'Giai ƒêo·∫°n 1: X√¢y D·ª±ng N·ªÅn T·∫£ng';
            else if (week <= 13) phaseText = 'Giai ƒêo·∫°n 2: ƒê·ªânh Cao Phong ƒê·ªô';
            else phaseText = 'Giai ƒêo·∫°n 3: Taper & Thi ƒê·∫•u';
            phaseInfo.textContent = phaseText;

            const weekData = getWeekData(week);
            scheduleGrid.innerHTML = '';
            const days = ['Th·ª© Hai', 'Th·ª© Ba', 'Th·ª© T∆∞', 'Th·ª© NƒÉm', 'Th·ª© S√°u', 'Th·ª© B·∫£y', 'Ch·ªß Nh·∫≠t'];
            
            let dayIndex = 0;
            for (const day in weekData) {
                const dayInfo = weekData[day];
                let gymHtml = '';
                if (dayInfo.gym) {
                    gymHtml = `
                        <div class="mt-3 pt-3 border-t border-gray-200">
                            <h5 class="font-bold text-gray-700">üèãÔ∏è‚Äç‚ôÇÔ∏è Gym (${dayInfo.gym.type})</h5>
                            <ul class="list-disc list-inside text-sm text-gray-600 mt-1 pl-2">
                                ${dayInfo.gym.exercises.map(ex => `<li>${ex}</li>`).join('')}
                            </ul>
                        </div>`;
                }

                let runHtml = '';
                if (dayInfo.run) {
                     runHtml = `<div class="mt-2"><h5 class="font-bold text-gray-700">üèÉ‚Äç‚ôÇÔ∏è Ch·∫°y B·ªô</h5><p class="text-sm text-gray-600">${dayInfo.run}</p></div>`;
                }

                const dayCard = `
                    <div class="card p-4 flex flex-col h-full">
                        <h4 class="font-bold text-lg text-center text-[#3B5A5C] pb-2 border-b">${days[dayIndex]}</h4>
                        <div class="flex-grow mt-2">
                            ${runHtml}
                            ${gymHtml}
                        </div>
                    </div>
                `;
                scheduleGrid.innerHTML += dayCard;
                dayIndex++;
            }
        }

        weekSelector.addEventListener('input', (e) => {
            renderSchedule(e.target.value);
        });

        function displayTodaysPlan() {
            const today = new Date();
            const dayOfWeek = today.getDay(); // Sunday - 0, Monday - 1, ...
            const week = 1; 
            const weekData = getWeekData(week);
            const dayNames = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
            const dayKey = dayNames[dayOfWeek];
            const todayData = weekData[dayKey];

            const container = document.getElementById('today-plan-container');
            document.getElementById('today-date').textContent = today.toLocaleDateString('vi-VN', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });

            let content = '';
            if (todayData.run) {
                content += `<div class="card p-4">
                    <p class="font-bold text-lg">üèÉ‚Äç‚ôÇÔ∏è Ch·∫°y S√°ng:</p>
                    <p class="text-gray-700">${todayData.run}</p>
                </div>`;
            }
            if (todayData.gym) {
                content += `<div class="card p-4">
                    <p class="font-bold text-lg">üèãÔ∏è‚Äç‚ôÇÔ∏è Gym T·ªëi (${todayData.gym.type}):</p>
                    <ul class="list-disc list-inside text-gray-700 mt-1 pl-4">
                        ${todayData.gym.exercises.map(ex => `<li>${ex}</li>`).join('')}
                    </ul>
                </div>`;
            }
             if (!todayData.run && !todayData.gym) {
                content = `<div class="card p-4"><p class="font-bold text-lg">H√¥m nay l√† ng√†y ngh·ªâ ng∆°i! H√£y t·∫≠n h∆∞·ªüng v√† ph·ª•c h·ªìi nh√©.</p></div>`;
            }
            container.innerHTML = content;
        }

        document.querySelectorAll('.accordion-header').forEach(button => {
            button.addEventListener('click', () => {
                const accordionContent = button.nextElementSibling;
                const isExpanded = accordionContent.style.maxHeight && accordionContent.style.maxHeight !== '0px';
                
                document.querySelectorAll('.accordion-content').forEach(content => content.style.maxHeight = '0px');
                document.querySelectorAll('.accordion-header span:last-child').forEach(span => span.textContent = '+');

                if (!isExpanded) {
                    accordionContent.style.maxHeight = accordionContent.scrollHeight + "px";
                    button.querySelector('span:last-child').textContent = '-';
                }
            });
        });

        renderSchedule(1);
        displayTodaysPlan();
        navigateTo('dashboard');
    });
</script>

</body>
</html>
