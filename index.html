<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>B·∫£ng ƒêi·ªÅu Khi·ªÉn V·∫≠n ƒê·ªông Vi√™n Hybrid</title>
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#4A6C6F">
    <meta name="background-color" content="#F8F7F4">
    <link rel="manifest" href="manifest.json">
    
    <!-- Icons cho t·∫•t c·∫£ devices -->
    <link rel="icon" type="image/png" sizes="72x72" href="icons/icon.png">
    <link rel="icon" type="image/png" sizes="96x96" href="icons/icon.png">
    <link rel="icon" type="image/png" sizes="144x144" href="icons/icon.png">
    <link rel="icon" type="image/png" sizes="192x192" href="icons/icon.png">
    <link rel="icon" type="image/png" sizes="512x512" href="icons/icon.png">
    
    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" sizes="72x72" href="icons/icon.png">
    <link rel="apple-touch-icon" sizes="96x96" href="icons/icon.png">
    <link rel="apple-touch-icon" sizes="144x144" href="icons/icon.png">
    <link rel="apple-touch-icon" sizes="192x192" href="icons/icon.png">
    
    <!-- PWA Meta Tags b·ªï sung -->
    <meta name="description" content="Ch∆∞∆°ng tr√¨nh t·∫≠p luy·ªán hybrid k·∫øt h·ª£p gym v√† ch·∫°y marathon 16 tu·∫ßn">
    <meta name="keywords" content="fitness, gym, marathon, hybrid training, workout, running">
    <meta name="author" content="Hybrid Training Team">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Hybrid Training">
    <meta name="msapplication-TileColor" content="#4A6C6F">
    <meta name="msapplication-TileImage" content="icons/icon.png">
    <meta name="application-name" content="Hybrid Training">
    <meta name="format-detection" content="telephone=no">

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Chosen Palette: Calm Focus -->
    <!-- Application Structure Plan: A tabbed, dashboard-style Single Page Application. The structure is task-oriented (Dashboard, Schedule, Nutrition, Recovery) rather than following the linear report format. This provides immediate, actionable information ('What's today's plan?') on the dashboard and allows for deep-dives into specific areas via tabs. The core interaction is a week selector on the 'Training Schedule' tab that dynamically updates a 7-day grid, with clickable days revealing detailed workouts. This design prioritizes usability and quick access to relevant daily information. -->
    <!-- Visualization & Content Choices: 1. **Personal Metrics (Dashboard): Goal: Inform.** Method: Dynamic stats in cards (HTML/Tailwind). Justification: Quick, scannable overview of key numbers. 2. **Macro Split (Dashboard/Nutrition): Goal: Proportions.** Method: Donut Chart (Chart.js). Justification: Classic, instant visual for part-to-whole relationships. 3. **Long Run Progression (Training): Goal: Change over time.** Method: Line Chart (Chart.js). Justification: Clearly shows the progressive overload principle applied to the key marathon training run. 4. **Weekly Schedule (Training): Goal: Organize.** Method: Interactive 7-day grid (HTML/Tailwind + JS). Interaction: Week selector updates the grid; clicking a day shows details. Justification: Most intuitive way to view a weekly calendar. Hiding details until clicked prevents information overload. 5. **Exercise/Recovery Details: Goal: Instruct.** Method: Accordions/Modals (HTML + JS). Justification: Hides complex information until requested, keeping the UI clean. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->

    <style>
        body {
            font-family: 'Be Vietnam Pro', sans-serif;
            background-color: #F8F7F4;
            color: #3D3B3A;
        }
        .nav-item {
            cursor: pointer;
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            transition: all 0.3s ease;
            color: #78716C;
            font-weight: 500;
        }
        .nav-item.active, .nav-item:hover {
            background-color: #4A6C6F;
            color: #FFFFFF;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 450px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 300px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
                max-height: 350px;
            }
        }
        .card {
            background-color: #FFFFFF;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.05), 0 2px 4px -2px rgb(0 0 0 / 0.05);
            transition: all 0.3s ease;
        }
        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.07), 0 4px 6px -4px rgb(0 0 0 / 0.07);
        }
        .section-title {
            color: #4A6C6F;
            font-weight: 700;
            font-size: 1.875rem;
            line-height: 2.25rem;
            border-bottom: 3px solid #D1D5DB;
            padding-bottom: 0.5rem;
        }
        .week-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            background: #4A6C6F;
            cursor: pointer;
            border-radius: 50%;
        }
        .week-slider::-moz-range-thumb {
            width: 24px;
            height: 24px;
            background: #4A6C6F;
            cursor: pointer;
            border-radius: 50%;
        }
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-out;
        }
        .exercise-item {
            cursor: pointer;
            transition: color 0.2s ease-in-out;
        }
        .exercise-item:hover {
            color: #4A6C6F;
            font-weight: 500;
        }
        .modal-overlay {
            transition: opacity 0.3s ease;
        }
        .modal-container {
            transition: transform 0.3s ease, opacity 0.3s ease;
        }
        .tab-btn {
            padding: 0.5rem 1rem;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            color: #6B7280;
            font-weight: 500;
        }
        .tab-btn.active-tab {
            color: #4A6C6F;
            border-color: #4A6C6F;
        }
        
        /* PWA Styles */
        .pwa-mode {
            padding-top: env(safe-area-inset-top);
            padding-bottom: env(safe-area-inset-bottom);
        }
        
        .pwa-mode header {
            padding-top: calc(1rem + env(safe-area-inset-top));
        }
        
        /* Mobile optimizations */
        @media (max-width: 768px) {
            .nav-item {
                padding: 0.5rem 0.75rem;
                font-size: 0.875rem;
            }
            
            .card:hover {
                transform: none; /* Disable hover effects on mobile */
            }
            
            .section-title {
                font-size: 1.5rem;
            }
        }
        
        /* Touch feedback */
        .nav-item:active, .exercise-item:active, button:active {
            transform: scale(0.95);
            transition: transform 0.1s ease;
        }
        
        /* Offline indicator */
        .offline-mode {
            filter: grayscale(0.3);
        }
        
        /* Install banner animation */
        @keyframes slideUp {
            from { transform: translateY(100%); }
            to { transform: translateY(0); }
        }
        
        /* Text truncation utility */
        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        /* Exercise item dashboard styles */
        .exercise-item-dashboard {
            transform: translateZ(0); /* GPU acceleration */
        }
        
        .exercise-item-dashboard:active {
            transform: scale(0.98);
            transition: transform 0.1s ease;
        }
        
        /* Smooth color transitions */
        .exercise-item-dashboard:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body class="antialiased">

    <div class="container mx-auto p-4 md:p-8 max-w-7xl">
        <!-- HEADER -->
        <header class="text-center mb-8">
            <h1 class="text-3xl md:text-5xl font-bold text-[#3B5A5C]">L·ªô Tr√¨nh V·∫≠n ƒê·ªông Vi√™n Hybrid</h1>
            <p class="text-lg text-gray-600 mt-2">16 Tu·∫ßn Chinh Ph·ª•c S·ª©c M·∫°nh & Marathon Sub 4:30</p>
        </header>

        <!-- NAVIGATION -->
        <nav class="flex flex-wrap justify-center items-center mb-8 bg-white/70 backdrop-blur-sm p-2 rounded-xl shadow-sm sticky top-4 z-50">
            <a id="nav-dashboard" class="nav-item active">üìä B·∫£ng ƒêi·ªÅu Khi·ªÉn</a>
            <a id="nav-schedule" class="nav-item">üóìÔ∏è L·ªãch T·∫≠p</a>
            <a id="nav-nutrition" class="nav-item">ü•ó Dinh D∆∞·ª°ng</a>
            <a id="nav-recovery" class="nav-item">üßò Ph·ª•c H·ªìi & T∆∞ Th·∫ø</a>
        </nav>

        <!-- MAIN CONTENT -->
        <main>
            <!-- DASHBOARD VIEW -->
            <section id="view-dashboard">
                <h2 class="section-title mb-6">B·∫£ng ƒêi·ªÅu Khi·ªÉn</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div class="md:col-span-2 lg:col-span-3 p-6 card bg-gradient-to-br from-teal-50 to-[#E0E7E9]">
                        <h3 class="text-2xl font-bold text-gray-800 mb-4">K·∫ø Ho·∫°ch H√¥m Nay (<span id="today-date"></span>)</h3>
                        <div id="today-plan-container" class="space-y-4"></div>
                    </div>
                    <div class="p-6 card">
                        <h3 class="text-xl font-bold mb-3 text-gray-800">Ch·ªâ S·ªë C√° Nh√¢n</h3>
                        <ul class="space-y-2 text-gray-700">
                            <li><strong>Tu·ªïi:</strong> 24</li>
                            <li><strong>Chi·ªÅu cao:</strong> 167 cm</li>
                            <li><strong>C√¢n n·∫∑ng:</strong> 58 kg</li>
                            <li><strong>M·ª•c ti√™u Marathon:</strong> < 4h30</li>
                        </ul>
                    </div>
                    <div class="p-6 card text-center flex flex-col justify-center items-center">
                        <h3 class="text-xl font-bold mb-2 text-gray-800">M·ª•c Ti√™u NƒÉng L∆∞·ª£ng</h3>
                        <p class="text-4xl font-bold text-[#4A6C6F]">~3000</p>
                        <p class="text-gray-600">kcal/ng√†y</p>
                        <p class="text-sm mt-2 text-gray-500">(BMR: ~1509 | TDEE: ~2603)</p>
                    </div>
                    <div class="p-6 card">
                        <h3 class="text-xl font-bold mb-3 text-center text-gray-800">Dinh D∆∞·ª°ng ƒêa L∆∞·ª£ng</h3>
                        <div class="chart-container">
                            <canvas id="macroChart"></canvas>
                        </div>
                         <div class="flex justify-around mt-4 text-xs md:text-sm text-center">
                            <div><span class="font-bold block text-blue-600">Carb</span>375g</div>
                            <div><span class="font-bold block text-green-600">Protein</span>225g</div>
                            <div><span class="font-bold block text-red-600">Fat</span>67g</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- SCHEDULE VIEW -->
            <section id="view-schedule" class="hidden">
                <h2 class="section-title mb-6">L·ªãch T·∫≠p Chi Ti·∫øt 16 Tu·∫ßn</h2>
                
                <div class="mb-8 p-4 card">
                    <label for="week-selector" class="block text-xl font-bold text-gray-800 mb-2">Ch·ªçn Tu·∫ßn: <span id="week-label" class="text-[#4A6C6F]">1</span></label>
                    <input type="range" id="week-selector" min="1" max="16" value="1" class="w-full h-3 bg-gray-200 rounded-lg appearance-none cursor-pointer week-slider">
                    <div id="phase-info" class="text-center font-semibold mt-2 text-gray-600"></div>
                </div>

                <div id="schedule-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-7 gap-4"></div>

                <div class="mt-12 p-6 card">
                    <h3 class="text-2xl font-bold mb-4 text-center text-gray-800">Ti·∫øn ƒê·ªô Ch·∫°y D√†i (Long Run)</h3>
                    <div class="chart-container h-64 md:h-80 max-w-4xl">
                        <canvas id="longRunChart"></canvas>
                    </div>
                </div>
            </section>

            <!-- NUTRITION VIEW -->
            <section id="view-nutrition" class="hidden">
                <h2 class="section-title mb-6">K·∫ø Ho·∫°ch Dinh D∆∞·ª°ng</h2>
                 <p class="mb-8 text-gray-700 max-w-4xl">Dinh d∆∞·ª°ng l√† n·ªÅn t·∫£ng cho s·ª± ph·ª•c h·ªìi v√† ph√°t tri·ªÉn. K·∫ø ho·∫°ch n√†y t·∫≠p trung v√†o vi·ªác n·∫°p ƒë·ªß nƒÉng l∆∞·ª£ng (~3000 kcal) v·ªõi t·ª∑ l·ªá dinh d∆∞·ª°ng ƒëa l∆∞·ª£ng t·ªëi ∆∞u (50% Carb, 30% Protein, 20% Fat) th√¥ng qua c√°c b·ªØa ƒÉn quen thu·ªôc c·ªßa ng∆∞·ªùi Vi·ªát. Ch√∫ tr·ªçng th·ªùi ƒëi·ªÉm n·∫°p nƒÉng l∆∞·ª£ng quanh c√°c bu·ªïi t·∫≠p l√† ch√¨a kh√≥a th√†nh c√¥ng.</p>
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <div class="lg:col-span-2">
                        <h3 class="text-2xl font-bold mb-4 text-gray-800">Th·ª±c ƒê∆°n M·∫´u (~3000 kcal)</h3>
                        <div class="space-y-4">
                            <div class="card p-4"><strong>B·ªØa 1 (6:30, Tr∆∞·ªõc ch·∫°y):</strong> 1 qu·∫£ chu·ªëi, c√† ph√™ ƒëen. (~120 kcal)</div>
                            <div class="card p-4"><strong>B·ªØa 2 (9:00, Sau ch·∫°y):</strong> 1 mu·ªóng whey protein + 250ml s·ªØa t∆∞∆°i + 1 qu·∫£ chu·ªëi. (~350 kcal)</div>
                            <div class="card p-4"><strong>B·ªØa 3 (12:00, Tr∆∞a):</strong> 1 t√¥ Ph·ªü b√≤ t√°i l·ªõn (th√™m th·ªãt). (~550 kcal)</div>
                            <div class="card p-4"><strong>B·ªØa 4 (15:30, Ph·ª•):</strong> 1 h·ªôp s·ªØa chua Hy L·∫°p + 30g h·∫°nh nh√¢n. (~350 kcal)</div>
                            <div class="card p-4"><strong>B·ªØa 5 (18:00, Tr∆∞·ªõc gym):</strong> 2 tr·ª©ng lu·ªôc + 1 khoai lang v·ª´a. (~320 kcal)</div>
                            <div class="card p-4"><strong>B·ªØa 6 (20:30, T·ªëi):</strong> 250g ·ª©c g√† n∆∞·ªõng + 2 b√°t c∆°m g·∫°o l·ª©t + rau lu·ªôc. (~900 kcal)</div>
                             <div class="card p-4"><strong>B·ªØa 7 (22:00, Ph·ª• t·ªëi):</strong> 1 ly s·ªØa h·∫°t ho·∫∑c ph√¥ mai Cottage. (~200 kcal)</div>
                        </div>
                    </div>
                    <div>
                        <h3 class="text-2xl font-bold mb-4 text-gray-800">Th∆∞ Vi·ªán Th·ª±c Ph·∫©m</h3>
                        <p class="mb-4 text-gray-600">Linh ho·∫°t l·ª±a ch·ªçn c√°c th·ª±c ph·∫©m sau ƒë·ªÉ x√¢y d·ª±ng b·ªØa ƒÉn c·ªßa b·∫°n.</p>
                        <div class="space-y-4">
                            <div><h4 class="font-bold text-lg text-green-700">Ngu·ªìn Protein Ch·∫•t L∆∞·ª£ng</h4><p class="text-gray-700">·ª®c g√†, b√≤ thƒÉn, c√° h·ªìi, c√° di√™u h·ªìng, t√¥m, tr·ª©ng, ƒë·∫≠u h≈©, s·ªØa chua Hy L·∫°p, whey.</p></div>
                            <div><h4 class="font-bold text-lg text-blue-700">Ngu·ªìn Carb Ph·ª©c H·ª£p</h4><p class="text-gray-700">C∆°m (g·∫°o l·ª©t, tr·∫Øng), b√∫n, ph·ªü, khoai lang, y·∫øn m·∫°ch, b√°nh m√¨ nguy√™n c√°m, chu·ªëi, xo√†i.</p></div>
                            <div><h4 class="font-bold text-lg text-red-700">Ngu·ªìn Ch·∫•t B√©o T·ªët</h4><p class="text-gray-700">D·∫ßu √¥ liu, qu·∫£ b∆°, h·∫°nh nh√¢n, √≥c ch√≥, b∆° ƒë·∫≠u ph·ªông, l√≤ng ƒë·ªè tr·ª©ng.</p></div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- RECOVERY VIEW -->
            <section id="view-recovery" class="hidden">
                 <h2 class="section-title mb-6">Ph·ª•c H·ªìi & C·∫£i Thi·ªán T∆∞ Th·∫ø</h2>
                 <p class="mb-8 text-gray-700 max-w-4xl">S·ª± ti·∫øn b·ªô kh√¥ng x·∫£y ra trong l√∫c t·∫≠p m√† l√† trong l√∫c ngh·ªâ ng∆°i. ∆Øu ti√™n ph·ª•c h·ªìi th√¥ng qua gi·∫•c ng·ªß, gi√£n c∆° v√† c√°c b√†i t·∫≠p b·ªï tr·ª£ l√† y·∫øu t·ªë quy·∫øt ƒë·ªãnh ƒë·ªÉ b·∫°n m·∫°nh h∆°n, nhanh h∆°n v√† tr√°nh xa ch·∫•n th∆∞∆°ng. Ph·∫ßn n√†y ƒë·∫∑c bi·ªát t·∫≠p trung v√†o c√°c b√†i t·∫≠p kh·∫Øc ph·ª•c ch·ª©ng g√π l∆∞ng.</p>
                <div class="space-y-6">
                    <div class="card p-6">
                        <h3 class="text-2xl font-bold mb-4 text-gray-800">K·∫ø Ho·∫°ch C·∫£i Thi·ªán T∆∞ Th·∫ø (Ch·ªëng G√π L∆∞ng)</h3>
                        <p class="mb-4 text-gray-600">T√≠ch h·ª£p c√°c b√†i t·∫≠p n√†y v√†o ng√†y t·∫≠p PULL v√† ph·∫ßn kh·ªüi ƒë·ªông ƒë·ªÉ tƒÉng c∆∞·ªùng s·ª©c m·∫°nh cho l∆∞ng tr√™n, k√©o vai v·ªÅ v·ªã tr√≠ t·ª± nhi√™n.</p>
                        <div class="space-y-2">
                             <div class="accordion-item border-b"><button class="accordion-header w-full text-left py-3 font-semibold text-lg flex justify-between items-center"><span>Face Pulls (B√†i t·∫≠p Vua)</span><span>+</span></button><div class="accordion-content"><p class="p-4 text-gray-700 bg-gray-50 rounded"><strong>M·ª•c ti√™u:</strong> TƒÉng c∆∞·ªùng c∆° delta sau v√† c√°c c∆° xoay ngo√†i vai.<br><strong>Th·ª±c hi·ªán:</strong> 3 hi·ªáp x 15-20 l·∫ßn l·∫∑p v√†o cu·ªëi bu·ªïi t·∫≠p Pull. K√©o d√¢y c√°p v·ªÅ ph√≠a m·∫∑t, t·∫≠p trung √©p hai b·∫£ vai v√†o nhau.</p></div></div>
                             <div class="accordion-item border-b"><button class="accordion-header w-full text-left py-3 font-semibold text-lg flex justify-between items-center"><span>Wall Angels</span><span>+</span></button><div class="accordion-content"><p class="p-4 text-gray-700 bg-gray-50 rounded"><strong>M·ª•c ti√™u:</strong> K√≠ch ho·∫°t c∆° thang gi·ªØa v√† d∆∞·ªõi.<br><strong>Th·ª±c hi·ªán:</strong> 2 hi·ªáp x 10-12 l·∫ßn l·∫∑p khi kh·ªüi ƒë·ªông. ƒê·ª©ng d·ª±a l∆∞ng v√†o t∆∞·ªùng, tr∆∞·ª£t tay l√™n xu·ªëng trong khi gi·ªØ khu·ª∑u tay v√† mu b√†n tay ch·∫°m t∆∞·ªùng.</p></div></div>
                             <div class="accordion-item border-b"><button class="accordion-header w-full text-left py-3 font-semibold text-lg flex justify-between items-center"><span>Band Pull-Aparts</span><span>+</span></button><div class="accordion-content"><p class="p-4 text-gray-700 bg-gray-50 rounded"><strong>M·ª•c ti√™u:</strong> K√≠ch ho·∫°t l∆∞ng tr√™n.<br><strong>Th·ª±c hi·ªán:</strong> 3 hi·ªáp x 20 l·∫ßn l·∫∑p. D√πng d√¢y kh√°ng l·ª±c, k√©o hai tay sang ngang, gi·ªØ tay th·∫≥ng. C√≥ th·ªÉ t·∫≠p gi·ªØa c√°c hi·ªáp c·ªßa ng√†y PUSH.</p></div></div>
                        </div>
                    </div>
                    <div class="card p-6">
                        <h3 class="text-2xl font-bold mb-4 text-gray-800">Gi√£n C∆° & LƒÉn B·ªçt (Foam Rolling)</h3>
                        <ul class="list-disc list-inside space-y-2 text-gray-700">
                           <li><strong>Kh·ªüi ƒë·ªông ƒë·ªông (5-10 ph√∫t):</strong> Lu√¥n th·ª±c hi·ªán tr∆∞·ªõc m·ªói bu·ªïi t·∫≠p.</li>
                           <li><strong>Gi√£n c∆° tƒ©nh (10-15 ph√∫t):</strong> Th·ª±c hi·ªán sau m·ªói bu·ªïi t·∫≠p khi c∆° c√≤n ·∫•m.</li>
                           <li><strong>LƒÉn b·ªçt:</strong> 2-3 l·∫ßn/tu·∫ßn, t·∫≠p trung v√†o c√°c nh√≥m c∆° l·ªõn b·ªã ƒëau m·ªèi.</li>
                        </ul>
                    </div>
                    <div class="card p-6">
                        <h3 class="text-2xl font-bold mb-4 text-gray-800">Gi·∫•c Ng·ªß & Ng√†y Ngh·ªâ</h3>
                        <ul class="list-disc list-inside space-y-2 text-gray-700">
                            <li><strong>Gi·∫•c ng·ªß:</strong> M·ª•c ti√™u 7-9 ti·∫øng/ƒë√™m.</li>
                            <li><strong>Ph·ª•c h·ªìi ch·ªß ƒë·ªông (Th·ª© 4):</strong> ƒêi b·ªô nh·∫π, b∆°i l·ªôi ho·∫∑c yoga.</li>
                            <li><strong>Ngh·ªâ ho√†n to√†n (Th·ª© 7):</strong> Cho ph√©p c∆° th·ªÉ v√† h·ªá th·∫ßn kinh ƒë∆∞·ª£c ngh·ªâ ng∆°i.</li>
                        </ul>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Exercise Detail Modal -->
    <div id="exercise-modal" class="modal-overlay fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-[100] hidden opacity-0">
        <div class="modal-container bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[95vh] overflow-y-auto p-6 relative opacity-0 transform scale-95">
            <button id="close-modal-btn" class="absolute top-4 right-4 text-gray-500 hover:text-gray-800 text-3xl">&times;</button>
            <h3 id="modal-title" class="text-2xl font-bold text-gray-800 mb-4"></h3>
            <div class="mb-4 border-b border-gray-200">
                <nav class="flex space-x-2" aria-label="Tabs">
                    <button id="tab-video" class="tab-btn active-tab">Video H∆∞·ªõng D·∫´n</button>
                </nav>
            </div>
            <div class="space-y-6">
                <div id="media-container" class="w-full aspect-video bg-gray-200 rounded-lg shadow-md overflow-hidden">
                    <!-- Video will be injected here by JS -->
                </div>
                <div class="bg-gray-50 rounded-lg p-4">
                    <h4 class="font-bold text-lg mb-3 text-gray-800 flex items-center">
                        <span class="text-blue-600 mr-2">üéØ</span>
                        H∆∞·ªõng D·∫´n Th·ª±c Hi·ªán
                    </h4>
                    <div id="modal-description" class="text-gray-700 space-y-2"></div>
                </div>
            </div>
        </div>
    </div>


<script>
    // PWA Service Worker Registration
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
            navigator.serviceWorker.register('/sw.js')
                .then(registration => console.log('Service Worker registered: ', registration))
                .catch(registrationError => console.log('Service Worker registration failed: ', registrationError));
        });
    }

    document.addEventListener('DOMContentLoaded', function() {
        const views = {
            dashboard: document.getElementById('view-dashboard'),
            schedule: document.getElementById('view-schedule'),
            nutrition: document.getElementById('view-nutrition'),
            recovery: document.getElementById('view-recovery'),
        };

        const navItems = {
            dashboard: document.getElementById('nav-dashboard'),
            schedule: document.getElementById('nav-schedule'),
            nutrition: document.getElementById('nav-nutrition'),
            recovery: document.getElementById('nav-recovery'),
        };

        const exerciseDetails = {
            "Barbell Bench Press": { 
                reps: "4x8-10", 
                description: "N·∫±m tr√™n gh·∫ø ph·∫≥ng, ch√¢n ƒë·∫∑t ch·∫Øc tr√™n s√†n. N·∫Øm t·∫° ƒë√≤n r·ªông h∆°n vai.\nH·∫° t·∫° xu·ªëng gi·ªØa ng·ª±c c√≥ ki·ªÉm so√°t, khu·ª∑u tay t·∫°o g√≥c 45-75 ƒë·ªô.\nƒê·∫©y m·∫°nh t·∫° l√™n v·ªã tr√≠ ban ƒë·∫ßu.", 
                imageUrl: "https://www.bodybuilding.com/images/2020/xdb/cropped/xdb-47b-barbell-bench-press-m1-square-600x600.jpg", 
                videoUrl: "https://www.youtube.com/embed/rT7DgCr-3pg" 
            },
            "Incline Dumbbell Press": { 
                reps: "3x10-12", 
                description: "N·∫±m tr√™n gh·∫ø d·ªëc l√™n (30-45 ƒë·ªô). M·ªói tay c·∫ßm m·ªôt t·∫° ƒë∆°n.\nD√πng ƒë√πi n√¢ng t·∫° l√™n v·ªã tr√≠ ngang vai.\nƒê·∫©y t·∫° l√™n tr√™n cho ƒë·∫øn khi hai tay g·∫ßn th·∫≥ng, sau ƒë√≥ t·ª´ t·ª´ h·∫° xu·ªëng.", 
                imageUrl: "https://www.bodybuilding.com/images/2020/xdb/cropped/xdb-26d-incline-dumbbell-bench-press-m1-square-600x600.jpg", 
                videoUrl: "https://www.youtube.com/embed/8iPEnn-ltC8" 
            },
            "Overhead Press": { 
                reps: "4x8-10", 
                description: "ƒê·ª©ng th·∫≥ng, ch√¢n r·ªông b·∫±ng vai. Gi·ªØ t·∫° ƒë√≤n ·ªü ph√≠a tr∆∞·ªõc vai.\nG·ªìng ch·∫∑t c∆° b·ª•ng v√† m√¥ng. ƒê·∫©y t·∫° th·∫≥ng l√™n tr√™n ƒë·∫ßu.\nT·ª´ t·ª´ h·∫° t·∫° tr·ªü l·∫°i.", 
                imageUrl: "https://www.bodybuilding.com/images/2020/xdb/cropped/xdb-50b-standing-barbell-shoulder-press-m1-square-600x600.jpg", 
                videoUrl: "https://www.youtube.com/embed/2yjwXTZQDDI" 
            },
            "Dumbbell Lateral Raises": { 
                reps: "3x12-15", 
                description: "ƒê·ª©ng th·∫≥ng, hai tay c·∫ßm t·∫° ƒë∆°n d·ªçc b√™n h√¥ng.\nGi·ªØ khu·ª∑u tay h∆°i cong, n√¢ng t·∫° sang hai b√™n cho ƒë·∫øn khi ngang vai.\nT·ª´ t·ª´ h·∫° t·∫° xu·ªëng.", 
                imageUrl: "https://www.bodybuilding.com/images/2020/xdb/cropped/xdb-17d-dumbbell-lateral-raise-m1-square-600x600.jpg", 
                videoUrl: "https://www.youtube.com/embed/3VcKaXpzqRo" 
            },
            "Triceps Pushdowns": { 
                reps: "3x12-15", 
                description: "ƒê·ª©ng tr∆∞·ªõc m√°y k√©o c√°p. N·∫Øm l·∫•y thanh k√©o, gi·ªØ khu·ª∑u tay s√°t th√¢n ng∆∞·ªùi.\nK√©o thanh xu·ªëng cho ƒë·∫øn khi tay th·∫≥ng ho√†n to√†n.\nT·ª´ t·ª´ th·∫£ tay v·ªÅ v·ªã tr√≠ ban ƒë·∫ßu.", 
                imageUrl: "https://www.bodybuilding.com/images/2020/xdb/cropped/xdb-7c-cable-push-down-m1-square-600x600.jpg", 
                videoUrl: "https://www.youtube.com/embed/2-LAMcpzODU" 
            },
            "Deadlifts": { 
                reps: "4x6-8", 
                description: "ƒê·ª©ng ch√¢n r·ªông b·∫±ng h√¥ng, ·ªëng ch√¢n g·∫ßn t·∫°. N·∫Øm t·∫°, tay r·ªông h∆°n vai.\nGi·ªØ l∆∞ng th·∫≥ng, ng·ª±c ∆∞·ª°n. K√©o b·∫±ng c√°ch ƒë·∫°p m·∫°nh ch√¢n xu·ªëng s√†n.\nKhi ƒë·ª©ng th·∫≥ng, k√©o vai v·ªÅ sau. H·∫° t·∫° b·∫±ng c√°ch ƒë·∫£o ng∆∞·ª£c chuy·ªÉn ƒë·ªông.", 
                imageUrl: "https://www.bodybuilding.com/images/2020/xdb/cropped/xdb-59b-barbell-deadlift-m1-square-600x600.jpg", 
                videoUrl: "https://www.youtube.com/embed/hCDzSR6bW10" 
            },
            "Pull-ups": { 
                reps: "4x8-12", 
                description: "N·∫Øm thanh x√† v·ªõi tay r·ªông h∆°n vai. K√©o ng∆∞·ªùi l√™n cho ƒë·∫øn khi c·∫±m v∆∞·ª£t qua thanh x√†.\nH·∫° ng∆∞·ªùi xu·ªëng m·ªôt c√°ch c√≥ ki·ªÉm so√°t.", 
                imageUrl: "https://www.bodybuilding.com/images/2020/xdb/cropped/xdb-1m-pull-up-m1-square-600x600.jpg", 
                videoUrl: "https://www.youtube.com/embed/eGo4IYlbE5g" 
            },
            "Lat Pulldowns": { 
                reps: "4x8-12", 
                description: "Ng·ªìi v√†o m√°y, n·∫Øm thanh k√©o. K√©o thanh xu·ªëng tr∆∞·ªõc ng·ª±c, t·∫≠p trung d√πng c∆° x√¥.\nT·ª´ t·ª´ th·∫£ l·∫°i.", 
                imageUrl: "https://www.bodybuilding.com/images/2020/xdb/cropped/xdb-12c-lat-pull-down-m1-square-600x600.jpg", 
                videoUrl: "https://www.youtube.com/embed/SALxEARiMkw"
            },
            "Bent-Over Barbell Rows": { 
                reps: "3x8-10", 
                description: "G·∫≠p ng∆∞·ªùi ·ªü h√¥ng, gi·ªØ l∆∞ng th·∫≥ng g·∫ßn song song v·ªõi s√†n. N·∫Øm t·∫° ƒë√≤n.\nK√©o t·∫° v·ªÅ ph√≠a b·ª•ng d∆∞·ªõi, √©p hai b·∫£ vai v√†o nhau.\nT·ª´ t·ª´ h·∫° t·∫° xu·ªëng.", 
                imageUrl: "https://www.bodybuilding.com/images/2020/xdb/cropped/xdb-45b-bent-over-barbell-row-m1-square-600x600.jpg", 
                videoUrl: "https://www.youtube.com/embed/vT2GjY_Umpw" 
            },
            "Face Pulls": { 
                reps: "3x15-20", 
                description: "D√πng d√¢y th·ª´ng tr√™n m√°y k√©o c√°p ƒë·∫∑t ·ªü t·∫ßm cao. K√©o d√¢y v·ªÅ ph√≠a m·∫∑t, ƒë·ªìng th·ªùi xoay hai tay ra ngo√†i.\n√âp ch·∫∑t hai b·∫£ vai v√†o nhau ·ªü cu·ªëi ƒë·ªông t√°c.", 
                imageUrl: "https://www.bodybuilding.com/images/2020/xdb/cropped/xdb-8c-cable-face-pull-m1-square-600x600.jpg", 
                videoUrl: "https://www.youtube.com/embed/V8dZ3pyiCBo" 
            },
            "Barbell Curls": { 
                reps: "3x10-12", 
                description: "ƒê·ª©ng th·∫≥ng, hai tay c·∫ßm t·∫° ƒë√≤n. Gi·ªØ khu·ª∑u tay s√°t th√¢n ng∆∞·ªùi, cu·ªôn t·∫° l√™n v·ªÅ ph√≠a vai.\nT·ª´ t·ª´ h·∫° xu·ªëng.", 
                imageUrl: "https://www.bodybuilding.com/images/2020/xdb/cropped/xdb-42b-barbell-curl-m1-square-600x600.jpg", 
                videoUrl: "https://www.youtube.com/embed/kwG2ipFRgfo" 
            },
            "Barbell Back Squats": { 
                reps: "4x8-10", 
                description: "ƒê·∫∑t t·∫° l√™n ph·∫ßn c∆° thang sau vai. ƒê·ª©ng hai ch√¢n r·ªông b·∫±ng vai.\nH·∫° ng∆∞·ªùi xu·ªëng nh∆∞ ng·ªìi gh·∫ø, gi·ªØ l∆∞ng th·∫≥ng.\nXu·ªëng ƒë·∫øn khi ƒë√πi song song s√†n ho·∫∑c s√¢u h∆°n, r·ªìi ƒë·∫©y ng∆∞·ªùi l√™n.", 
                imageUrl: "https://www.bodybuilding.com/images/2020/xdb/cropped/xdb-48b-barbell-back-squat-m1-square-600x600.jpg", 
                videoUrl: "https://www.youtube.com/embed/gcNh17Ckjgg" 
            },
            "Romanian Deadlifts": { 
                reps: "3x10-12", 
                description: "Gi·ªØ t·∫° ƒë√≤n tr∆∞·ªõc ƒë√πi. ƒê·∫©y h√¥ng ra sau, g·∫≠p ng∆∞·ªùi v·ªÅ ph√≠a tr∆∞·ªõc.\nGi·ªØ l∆∞ng th·∫≥ng, g·ªëi h∆°i cong. H·∫° t·∫° ƒë·∫øn khi c·∫£m th·∫•y c∆° ƒë√πi sau cƒÉng.\nD√πng m√¥ng v√† ƒë√πi sau k√©o ng∆∞·ªùi l·∫°i.", 
                imageUrl: "https://www.bodybuilding.com/images/2020/xdb/cropped/xdb-60b-barbell-romanian-deadlift-m1-square-600x600.jpg", 
                videoUrl: "https://www.youtube.com/embed/JCX0TlL-_20" 
            },
            "Dumbbell Lunges": { 
                reps: "3x10-12/ch√¢n", 
                description: "M·ªói tay c·∫ßm m·ªôt t·∫° ƒë∆°n. B∆∞·ªõc m·ªôt ch√¢n d√†i v·ªÅ ph√≠a tr∆∞·ªõc.\nH·∫° c∆° th·ªÉ cho ƒë·∫øn khi c·∫£ hai g·ªëi t·∫°o g√≥c 90 ƒë·ªô.\nƒê·∫©y ng∆∞·ªùi l·∫°i v√† l·∫∑p l·∫°i v·ªõi ch√¢n kia.", 
                imageUrl: "https://www.bodybuilding.com/images/2020/xdb/cropped/xdb-30d-dumbbell-lunge-m1-square-600x600.jpg", 
                videoUrl: "https://www.youtube.com/embed/D7KaRcUTQeE" 
            },
            "Leg Press": { 
                reps: "3x12-15", 
                description: "Ng·ªìi v√†o m√°y, ƒë·∫∑t ch√¢n l√™n b√†n ƒë·∫°p r·ªông b·∫±ng vai.\nT·ª´ t·ª´ h·∫° b√†n ƒë·∫°p xu·ªëng ƒë·∫øn khi g·ªëi t·∫°o g√≥c 90 ƒë·ªô.\nƒê·∫©y m·∫°nh b√†n ƒë·∫°p l·∫°i, kh√¥ng kh√≥a kh·ªõp g·ªëi.", 
                imageUrl: "https://www.bodybuilding.com/images/2020/xdb/cropped/xdb-67m-leg-press-m1-square-600x600.jpg", 
                videoUrl: "https://www.youtube.com/embed/IZ_9qg0o_b4" 
            },
            "Standing Calf Raises": { 
                reps: "4x15-20", 
                description: "ƒê·ª©ng tr√™n b·ª•c, ch·ªâ ƒë·ªÉ n·ª≠a b√†n ch√¢n tr∆∞·ªõc tr√™n b·ª•c.\nH·∫° g√≥t ch√¢n xu·ªëng th·∫•p nh·∫•t c√≥ th·ªÉ.\nNh√≥n g√≥t ch√¢n l√™n cao nh·∫•t c√≥ th·ªÉ.", 
                imageUrl: "https://www.bodybuilding.com/images/2020/xdb/cropped/xdb-72m-standing-calf-raise-m1-square-600x600.jpg", 
                videoUrl: "https://www.youtube.com/embed/d2-g20A54-M" 
            }
        };
        const trainingPlan = {
            push: ["Barbell Bench Press", "Incline Dumbbell Press", "Overhead Press", "Dumbbell Lateral Raises", "Triceps Pushdowns"],
            pull: ["Deadlifts", "Pull-ups", "Bent-Over Barbell Rows", "Face Pulls", "Barbell Curls"],
            legs: ["Barbell Back Squats", "Romanian Deadlifts", "Dumbbell Lunges", "Leg Press", "Standing Calf Raises"]
        };

        const runningData = {
                easy: { phase1: "5-8 km (Pace 7:25-7:55/km)", phase2: "6-10 km (Pace 7:25-7:55/km)" },
                quality: { 
                    phase1: "Intervals: 6x800m (Pace 5:20-5:35/km)", 
                    phase2: "Tempo Run: 6-8 km (Pace 6:15-6:25/km)" 
                },
                longRunKm: [12, 14, 16, 18, 16, 20, 22, 24, 26, 28, 30, 32, 28, 20, 12, 5],
                taper: {
                    week14: { easy: "5km", quality: "3km Tempo nh·∫π", long: "18-20km"},
                    week15: { easy: "4km", quality: "2km Tempo nh·∫π", long: "10-12km"},
                    week16: { easy: "3km", quality: "Ngh·ªâ", long: "RACE DAY!"},
                }
        };

        function getWeekData(week) {
            let gymSchedule = {
                push: trainingPlan.push,
                pull: trainingPlan.pull,
                legs: trainingPlan.legs,
            };
            let runSchedule = {
                easy: runningData.easy[week <= 8 ? 'phase1' : 'phase2'],
                quality: runningData.quality[week <= 8 ? 'phase1' : 'phase2'],
                long: `${runningData.longRunKm[week-1]} km (Pace 6:55-7:25/km)`,
            };

            if (week >= 14) { 
                const taperWeek = runningData.taper[`week${week}`];
                runSchedule = { ...taperWeek };
                if (week == 14) gymSchedule = {push: ["To√†n th√¢n nh·∫π"], pull: null, legs: null };
                else if (week == 15) gymSchedule = {push: null, pull: ["To√†n th√¢n r·∫•t nh·∫π"], legs: null };
                else gymSchedule = {push: null, pull: null, legs: null };
            }

            return {
                Mon: { run: runSchedule.easy, gym: { type: 'PUSH', exercises: gymSchedule.push }},
                Tue: { run: runSchedule.quality, gym: { type: 'PULL', exercises: gymSchedule.pull }},
                Wed: { run: "Ph·ª•c h·ªìi ch·ªß ƒë·ªông (ƒëi b·ªô/yoga)", gym: null },
                Thu: { run: runSchedule.easy, gym: { type: 'LEGS', exercises: gymSchedule.legs }},
                Fri: { run: null, gym: { type: 'TH·ªÇ THAO', exercises: ["ƒê√° b√≥ng h√†ng tu·∫ßn"] }},
                Sat: { run: "NGH·ªà HO√ÄN TO√ÄN", gym: null },
                Sun: { run: runSchedule.long, gym: null }
            };
        }
        
        function navigateTo(viewId) {
            Object.values(views).forEach(v => v.classList.add('hidden'));
            views[viewId].classList.remove('hidden');
            Object.values(navItems).forEach(item => item.classList.remove('active'));
            navItems[viewId].classList.add('active');
        }

        Object.keys(navItems).forEach(key => navItems[key].addEventListener('click', () => navigateTo(key)));
        
        const modal = document.getElementById('exercise-modal');
        const closeModalBtn = document.getElementById('close-modal-btn');
        const modalTitle = document.getElementById('modal-title');
        const modalDescription = document.getElementById('modal-description');
        const mediaContainer = document.getElementById('media-container');
        const tabVideo = document.getElementById('tab-video');
        let currentExerciseForModal = null;

        function updateMedia(type) {
            mediaContainer.innerHTML = '';
            if (!currentExerciseForModal) return;

            if (type === 'video' && currentExerciseForModal.videoUrl) {
                const iframe = document.createElement('iframe');
                iframe.className = 'w-full h-full absolute top-0 left-0';
                iframe.src = currentExerciseForModal.videoUrl;
                iframe.title = `Video h∆∞·ªõng d·∫´n ${modalTitle.textContent}`;
                iframe.setAttribute('frameborder', '0');
                iframe.setAttribute('allow', 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share');
                iframe.setAttribute('allowfullscreen', '');
                
                const wrapper = document.createElement('div');
                wrapper.className = 'relative w-full h-0 pb-[56.25%]'; // 16:9 aspect ratio
                wrapper.appendChild(iframe);
                mediaContainer.appendChild(wrapper);

                tabVideo.classList.add('active-tab');
            } else {
                // Hi·ªÉn th·ªã th√¥ng b√°o khi kh√¥ng c√≥ video
                const noVideoMsg = document.createElement('div');
                noVideoMsg.className = 'w-full h-64 flex items-center justify-center bg-gradient-to-br from-gray-100 to-gray-200 rounded-lg';
                noVideoMsg.innerHTML = `
                    <div class="text-center text-gray-500">
                        <span class="text-5xl mb-3 block">üé•</span>
                        <p class="font-medium text-lg">Ch∆∞a c√≥ video h∆∞·ªõng d·∫´n</p>
                        <p class="text-sm mt-1">Vui l√≤ng tham kh·∫£o ph·∫ßn m√¥ t·∫£ chi ti·∫øt b√™n d∆∞·ªõi</p>
                    </div>
                `;
                mediaContainer.appendChild(noVideoMsg);
                tabVideo.classList.add('active-tab');
            }
        }

        function showModal(exerciseName) {
            const exercise = exerciseDetails[exerciseName];
            if (!exercise) return;
            currentExerciseForModal = exercise;

            modalTitle.textContent = exerciseName;
            
            // Enhanced description with reps info
            const descriptionLines = exercise.description.split('\\n');
            const formattedDescription = descriptionLines.map(line => `<p class="mb-2">${line}</p>`).join('');
            
            modalDescription.innerHTML = `
                <div class="mb-4 p-3 bg-blue-50 rounded-lg border-l-4 border-blue-400">
                    <p class="font-semibold text-blue-800 mb-1 flex items-center">
                        <span class="mr-2">üìä</span>Sets & Reps
                    </p>
                    <p class="text-blue-700 font-medium text-lg">${exercise.reps}</p>
                </div>
                <div class="text-gray-700 space-y-3">
                    ${formattedDescription}
                </div>
                <div class="mt-4 p-4 bg-amber-50 rounded-lg border-l-4 border-amber-400">
                    <p class="font-semibold text-amber-800 mb-2 flex items-center">
                        <span class="mr-2">‚ö†Ô∏è</span>L∆∞u √ù An To√†n
                    </p>
                    <ul class="text-sm text-amber-700 space-y-1 list-disc list-inside">
                        <li>Lu√¥n kh·ªüi ƒë·ªông 5-10 ph√∫t tr∆∞·ªõc khi t·∫≠p</li>
                        <li>Gi·ªØ form chu·∫©n, ∆∞u ti√™n k·ªπ thu·∫≠t h∆°n tr·ªçng l∆∞·ª£ng</li>
                        <li>Th·ªü ƒë·ªÅu ƒë·∫∑n, kh√¥ng n√≠n th·ªü khi t·∫≠p</li>
                        <li>Ng·ª´ng ngay n·∫øu c·∫£m th·∫•y ƒëau b·∫•t th∆∞·ªùng</li>
                        <li>TƒÉng t·∫£i d·∫ßn d·∫ßn theo th·ªùi gian</li>
                    </ul>
                </div>
            `;

            tabVideo.classList.add('active-tab');

            updateMedia('video');

            modal.classList.remove('hidden');
            setTimeout(() => {
                modal.classList.remove('opacity-0');
                modal.querySelector('.modal-container').classList.remove('opacity-0', 'scale-95');
            }, 10);
        }

        function hideModal() {
            modal.classList.add('opacity-0');
            modal.querySelector('.modal-container').classList.add('opacity-0', 'scale-95');
            setTimeout(() => {
                modal.classList.add('hidden');
                mediaContainer.innerHTML = '';
                currentExerciseForModal = null;
            }, 300);
        }
        
        tabVideo.addEventListener('click', () => updateMedia('video'));
        closeModalBtn.addEventListener('click', hideModal);
        modal.addEventListener('click', e => e.target === modal && hideModal());

        const weekSelector = document.getElementById('week-selector');
        const weekLabel = document.getElementById('week-label');
        const scheduleGrid = document.getElementById('schedule-grid');
        const phaseInfo = document.getElementById('phase-info');

        function renderSchedule(week) {
            weekLabel.textContent = week;
            phaseInfo.textContent = week <= 8 ? 'Giai ƒêo·∫°n 1: N·ªÅn T·∫£ng' : (week <= 13 ? 'Giai ƒêo·∫°n 2: ƒê·ªânh Cao' : 'Giai ƒêo·∫°n 3: Taper');
            const weekData = getWeekData(week);
            scheduleGrid.innerHTML = '';
            const days = ['Th·ª© Hai', 'Th·ª© Ba', 'Th·ª© T∆∞', 'Th·ª© NƒÉm', 'Th·ª© S√°u', 'Th·ª© B·∫£y', 'Ch·ªß Nh·∫≠t'];
            
            Object.values(weekData).forEach((dayInfo, index) => {
                let gymHtml = '';
                if (dayInfo.gym && dayInfo.gym.exercises) {
                    gymHtml = `
                        <div class="mt-3 pt-3 border-t border-gray-200">
                            <h5 class="font-bold text-gray-700">üèãÔ∏è‚Äç‚ôÇÔ∏è Gym (${dayInfo.gym.type})</h5>
                            <ul class="list-disc list-inside text-sm text-gray-600 mt-1 pl-2 space-y-1">
                                ${dayInfo.gym.exercises.map(exName => {
                                    const ex = exerciseDetails[exName];
                                    return `<li class="exercise-item" data-name="${exName}">${exName}${ex ? `: ${ex.reps}` : ''}</li>`
                                }).join('')}
                            </ul>
                        </div>`;
                }
                const runHtml = dayInfo.run ? `<div class="mt-2"><h5 class="font-bold text-gray-700">üèÉ‚Äç‚ôÇÔ∏è Ch·∫°y B·ªô</h5><p class="text-sm text-gray-600">${dayInfo.run}</p></div>` : '';
                scheduleGrid.innerHTML += `<div class="card p-4 flex flex-col h-full"><h4 class="font-bold text-lg text-center text-[#3B5A5C] pb-2 border-b">${days[index]}</h4><div class="flex-grow mt-2">${runHtml}${gymHtml}</div></div>`;
            });
            
            document.querySelectorAll('.exercise-item').forEach(item => {
                item.addEventListener('click', (e) => showModal(e.target.dataset.name));
            });
        }

        weekSelector.addEventListener('input', e => renderSchedule(e.target.value));

        function displayTodaysPlan() {
            const today = new Date();
            const dayOfWeek = today.getDay(); 
            const week = 1; 
            const dayNames = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
            const todayData = getWeekData(week)[dayNames[dayOfWeek]];
            const container = document.getElementById('today-plan-container');
            document.getElementById('today-date').textContent = today.toLocaleDateString('vi-VN', { weekday: 'long', month: 'long', day: 'numeric' });

            let content = '';
            
            // Running plan
            if (todayData.run) {
                content += `
                    <div class="card p-4">
                        <div class="flex items-center mb-3">
                            <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mr-3">
                                <span class="text-2xl">üèÉ‚Äç‚ôÇÔ∏è</span>
                            </div>
                            <div>
                                <p class="font-bold text-lg text-gray-800">Ch·∫°y B·ªô S√°ng</p>
                                <p class="text-sm text-gray-500">Cardio Training</p>
                            </div>
                        </div>
                        <div class="bg-blue-50 rounded-lg p-3">
                            <p class="text-gray-700 font-medium">${todayData.run}</p>
                            <p class="text-xs text-gray-500 mt-1">üí° Tip: Kh·ªüi ƒë·ªông 5-10 ph√∫t tr∆∞·ªõc khi ch·∫°y</p>
                        </div>
                    </div>
                `;
            }
            
            // Gym plan with detailed exercises
            if (todayData.gym && todayData.gym.exercises) {
                content += `
                    <div class="card p-4">
                        <div class="flex items-center mb-3">
                            <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mr-3">
                                <span class="text-2xl">üèãÔ∏è‚Äç‚ôÇÔ∏è</span>
                            </div>
                            <div>
                                <p class="font-bold text-lg text-gray-800">Gym T·ªëi (${todayData.gym.type})</p>
                                <p class="text-sm text-gray-500">Strength Training</p>
                            </div>
                        </div>
                        <div class="space-y-3">
                            ${todayData.gym.exercises.map(exName => {
                                const ex = exerciseDetails[exName];
                                if (!ex) return `<div class="bg-gray-50 rounded-lg p-3">
                                    <p class="font-medium text-gray-700">${exName}</p>
                                </div>`;
                                
                                return `
                                    <div class="bg-green-50 rounded-lg p-3 cursor-pointer hover:bg-green-100 transition-colors exercise-item-dashboard" data-name="${exName}">
                                        <div class="flex items-start justify-between">
                                            <div class="flex-1">
                                                <p class="font-medium text-gray-800">${exName}</p>
                                                <p class="text-sm text-green-600 font-medium">${ex.reps}</p>
                                                <p class="text-xs text-gray-600 mt-1 line-clamp-2">${ex.description.split('\\n')[0]}</p>
                                            </div>
                                            <div class="flex items-center ml-3">
                                                ${ex.videoUrl ? '<span class="text-lg">üé•</span>' : '<span class="text-gray-400 text-lg">üìù</span>'}
                                                <span class="text-gray-400 ml-2">‚ñ∂</span>
                                            </div>
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                        <div class="mt-3 p-3 bg-amber-50 rounded-lg">
                            <p class="text-xs text-amber-700">
                                <span class="font-medium">üí° L∆∞u √Ω:</span> Click v√†o b√†i t·∫≠p ƒë·ªÉ xem h∆∞·ªõng d·∫´n chi ti·∫øt v√† video h∆∞·ªõng d·∫´n
                            </p>
                        </div>
                    </div>
                `;
            }
            
            // Rest day
            if (!content) {
                content = `
                    <div class="card p-4 text-center">
                        <div class="w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-3">
                            <span class="text-3xl">üßò‚Äç‚ôÇÔ∏è</span>
                        </div>
                        <p class="font-bold text-lg text-gray-800 mb-2">Ng√†y Ngh·ªâ Ng∆°i</p>
                        <p class="text-gray-600">H√¥m nay l√† ng√†y ph·ª•c h·ªìi! H√£y t·∫≠n h∆∞·ªüng v√† ƒë·ªÉ c∆° th·ªÉ ngh·ªâ ng∆°i.</p>
                        <div class="mt-3 p-3 bg-purple-50 rounded-lg">
                            <p class="text-sm text-purple-700">üíú C√≥ th·ªÉ th·ª±c hi·ªán: ƒêi b·ªô nh·∫π, yoga, massage, ng·ªß ƒë·ªß gi·∫•c</p>
                        </div>
                    </div>
                `;
            }
            
            container.innerHTML = content;
            
            // Add click events for exercise items in dashboard
            document.querySelectorAll('.exercise-item-dashboard').forEach(item => {
                item.addEventListener('click', (e) => {
                    e.preventDefault();
                    vibrate([30]); // Haptic feedback
                    showModal(e.currentTarget.dataset.name);
                });
            });
        }

        document.querySelectorAll('.accordion-header').forEach(button => {
            button.addEventListener('click', () => {
                const content = button.nextElementSibling;
                const isExpanded = content.style.maxHeight && content.style.maxHeight !== '0px';
                document.querySelectorAll('.accordion-content').forEach(c => c.style.maxHeight = '0px');
                document.querySelectorAll('.accordion-header span:last-child').forEach(s => s.textContent = '+');
                if (!isExpanded) {
                    content.style.maxHeight = content.scrollHeight + "px";
                    button.querySelector('span:last-child').textContent = '-';
                }
            });
        });

        // Initial Renders and Chart setups
        new Chart(document.getElementById('macroChart').getContext('2d'), { type: 'doughnut', data: { labels: ['Carbohydrate (50%)', 'Protein (30%)', 'Ch·∫•t b√©o (20%)'], datasets: [{ data: [50, 30, 20], backgroundColor: ['#3B82F6', '#10B981', '#EF4444'], borderColor: '#F8F7F4', borderWidth: 4, hoverOffset: 8 }] }, options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'bottom', labels: { font: { family: "'Be Vietnam Pro', sans-serif", size: 12 }, boxWidth: 20, padding: 20 } } }, cutout: '60%' } });
        new Chart(document.getElementById('longRunChart').getContext('2d'), { type: 'line', data: { labels: Array.from({length: 16}, (_, i) => `Tu·∫ßn ${i + 1}`), datasets: [{ label: 'Qu√£ng ƒë∆∞·ªùng Ch·∫°y D√†i (km)', data: runningData.longRunKm, fill: true, backgroundColor: 'rgba(74, 108, 111, 0.1)', borderColor: '#4A6C6F', tension: 0.3, pointBackgroundColor: '#4A6C6F', pointRadius: 4, }] }, options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: true, title: { display: true, text: 'Qu√£ng ƒë∆∞·ªùng (km)' } }, x: { title: { display: true, text: 'Tu·∫ßn Luy·ªán T·∫≠p' } } }, plugins: { legend: { display: false } } } });

        renderSchedule(1);
        displayTodaysPlan();
        navigateTo('dashboard');

        // PWA Functionality
        initializePWA();

        // PWA Functions
        function initializePWA() {
            // Register Service Worker
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('/hybrid-tranning/sw.js')
                    .then(registration => {
                        console.log('‚úÖ SW registered:', registration);
                        checkForSWUpdate(registration);
                    })
                    .catch(error => console.log('‚ùå SW registration failed:', error));
            }

            // Handle install prompt
            let deferredPrompt;
            window.addEventListener('beforeinstallprompt', (e) => {
                e.preventDefault();
                deferredPrompt = e;
                showInstallBanner();
            });

            // Check if app is running in PWA mode
            if (window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone) {
                console.log('üöÄ App running in PWA mode!');
                document.body.classList.add('pwa-mode');
            }

            // Handle orientation changes for mobile
            window.addEventListener('orientationchange', () => {
                setTimeout(() => {
                    window.location.reload();
                }, 100);
            });

            // Touch gestures for mobile
            addTouchGestures();
            
            // Check connection status
            updateConnectionStatus();
            window.addEventListener('online', updateConnectionStatus);
            window.addEventListener('offline', updateConnectionStatus);
        }

        function checkForSWUpdate(registration) {
            registration.addEventListener('updatefound', () => {
                const newWorker = registration.installing;
                newWorker.addEventListener('statechange', () => {
                    if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                        showUpdateBanner();
                    }
                });
            });
        }

        function showInstallBanner() {
            if (document.getElementById('install-banner')) return;
            
            const banner = document.createElement('div');
            banner.id = 'install-banner';
            banner.className = 'fixed bottom-4 left-4 right-4 bg-[#4A6C6F] text-white p-4 rounded-lg shadow-lg z-50 transform translate-y-full transition-transform duration-300';
            banner.innerHTML = `
                <div class="flex items-center justify-between">
                    <div class="flex items-center">
                        <div class="w-10 h-10 bg-white rounded-lg flex items-center justify-center mr-3">
                            <span class="text-[#4A6C6F] text-lg">üèãÔ∏è‚Äç‚ôÇÔ∏è</span>
                        </div>
                        <div>
                            <div class="font-bold">C√†i ƒë·∫∑t Hybrid Training</div>
                            <div class="text-sm opacity-90">Th√™m v√†o m√†n h√¨nh ch√≠nh ƒë·ªÉ truy c·∫≠p nhanh</div>
                        </div>
                    </div>
                    <div class="flex gap-2">
                        <button id="install-btn" class="bg-white text-[#4A6C6F] px-3 py-1 rounded font-medium">C√†i ƒë·∫∑t</button>
                        <button id="dismiss-install" class="text-white opacity-70 hover:opacity-100">‚úï</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(banner);
            setTimeout(() => banner.classList.remove('translate-y-full'), 100);

            document.getElementById('install-btn').addEventListener('click', async () => {
                if (deferredPrompt) {
                    deferredPrompt.prompt();
                    const { outcome } = await deferredPrompt.userChoice;
                    console.log('Install prompt outcome:', outcome);
                    deferredPrompt = null;
                    banner.remove();
                }
            });

            document.getElementById('dismiss-install').addEventListener('click', () => {
                banner.classList.add('translate-y-full');
                setTimeout(() => banner.remove(), 300);
            });
        }

        function showUpdateBanner() {
            const banner = document.createElement('div');
            banner.className = 'fixed top-4 left-4 right-4 bg-blue-600 text-white p-4 rounded-lg shadow-lg z-50';
            banner.innerHTML = `
                <div class="flex items-center justify-between">
                    <div>
                        <div class="font-bold">C·∫≠p nh·∫≠t m·ªõi c√≥ s·∫µn!</div>
                        <div class="text-sm opacity-90">Kh·ªüi ƒë·ªông l·∫°i ƒë·ªÉ c·∫≠p nh·∫≠t</div>
                    </div>
                    <button id="update-btn" class="bg-white text-blue-600 px-3 py-1 rounded font-medium">C·∫≠p nh·∫≠t</button>
                </div>
            `;
            
            document.body.appendChild(banner);

            document.getElementById('update-btn').addEventListener('click', () => {
                if (navigator.serviceWorker.controller) {
                    navigator.serviceWorker.controller.postMessage({type: 'SKIP_WAITING'});
                }
                window.location.reload();
            });
        }

        function addTouchGestures() {
            let startX, startY, startTime;
            
            document.addEventListener('touchstart', (e) => {
                startX = e.touches[0].clientX;
                startY = e.touches[0].clientY;
                startTime = Date.now();
            }, { passive: true });

            document.addEventListener('touchend', (e) => {
                const endX = e.changedTouches[0].clientX;
                const endY = e.changedTouches[0].clientY;
                const endTime = Date.now();
                
                const deltaX = endX - startX;
                const deltaY = endY - startY;
                const deltaTime = endTime - startTime;
                
                // Swipe detection
                if (Math.abs(deltaX) > 50 && Math.abs(deltaY) < 100 && deltaTime < 300) {
                    if (deltaX > 0) {
                        // Swipe right - previous tab
                        switchTab(-1);
                    } else {
                        // Swipe left - next tab
                        switchTab(1);
                    }
                }
            }, { passive: true });
        }

        function switchTab(direction) {
            const tabs = ['dashboard', 'schedule', 'nutrition', 'recovery'];
            const currentIndex = tabs.findIndex(tab => !views[tab].classList.contains('hidden'));
            const newIndex = (currentIndex + direction + tabs.length) % tabs.length;
            navigateTo(tabs[newIndex]);
        }

        function updateConnectionStatus() {
            const statusEl = document.getElementById('connection-status') || createConnectionStatusElement();
            if (navigator.onLine) {
                statusEl.className = 'hidden';
            } else {
                statusEl.className = 'fixed top-0 left-0 right-0 bg-orange-500 text-white text-center py-2 z-50';
                statusEl.textContent = 'üì° ƒêang offline - D·ªØ li·ªáu ƒë∆∞·ª£c l∆∞u trong cache';
            }
        }

        function createConnectionStatusElement() {
            const statusEl = document.createElement('div');
            statusEl.id = 'connection-status';
            document.body.appendChild(statusEl);
            return statusEl;
        }

        // Vibration feedback for touch interactions
        function vibrate(pattern = [50]) {
            if ('vibrate' in navigator) {
                navigator.vibrate(pattern);
            }
        }

        // Add vibration to buttons
        document.addEventListener('click', (e) => {
            if (e.target.matches('button, .nav-item, .exercise-item')) {
                vibrate([30]);
            }
        });
    });
</script>

</body>
</html>
